{"ast":null,"code":"import { AlertBoxComponent } from 'src/app/shared/alert-box/alert-box.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"src/app/services/business-data.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/table\";\nimport * as i8 from \"@angular/material/stepper\";\nfunction ImportComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Import\");\n  }\n}\nfunction ImportComponent_th_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Name\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_td_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1, \"Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_th_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Amount\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1, \"Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_th_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Expense Date\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_td_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1, \"Required Format (DD/MM/YYYY)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_th_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Expense Category\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_td_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1, \"Optional(default - Unassigned)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_th_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Payment Type\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_td_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1, \"Optional(default - Card)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_th_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Comment\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_td_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1, \"Optional(default - Unassigned)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_tr_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 28);\n  }\n}\nfunction ImportComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 29);\n  }\n}\nfunction ImportComponent_ng_template_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Review\");\n  }\n}\nfunction ImportComponent_p_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Please Procced with Save Button..\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_p_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Please Reupload File in CSV format with Back Button\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImportComponent_ng_template_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"Done\");\n  }\n}\nexport let ImportComponent = /*#__PURE__*/(() => {\n  class ImportComponent {\n    constructor(route, dialog, snackBar, businessData) {\n      this.route = route;\n      this.dialog = dialog;\n      this.snackBar = snackBar;\n      this.businessData = businessData;\n      this.isCorrect = false;\n      this.displayedColumns = ['name', 'amount', 'date', 'category', 'payment', 'comment'];\n      this.dataSource = [{\n        name: '',\n        amount: '',\n        date: '',\n        category: '',\n        payment: '',\n        comment: ''\n      }];\n      this.propertyNames = [];\n      this.dataRows = [];\n      this.header = false;\n    }\n    ngOnInit() {}\n    onView() {\n      this.route.navigate(['dashboard']);\n    }\n    onSaveImport() {\n      this.propertyNames = this.csvRecords[0];\n      let hashamp = {};\n      let name = false;\n      let amount = false;\n      let expense_date = false;\n      let expense_category = false;\n      let payment_type = false;\n      let comment = false;\n      for (let j = 1; j < this.csvRecords.length - 1; j++) {\n        hashamp = {};\n        name = false;\n        amount = false;\n        expense_category = false;\n        expense_date = false;\n        payment_type = false;\n        comment = false;\n        for (let i = 0; i < this.propertyNames.length; i++) {\n          this.propertyNames[i].toLowerCase();\n          if (this.propertyNames[i] === 'name' || this.propertyNames[i] === 'expense_name' || this.propertyNames[i] === 'expense name') {\n            if (this.csvRecords[j][i] && (this.csvRecords[j][i] != '' || this.csvRecords[j][i] != ' ')) {\n              hashamp['expense_name'] = this.csvRecords[j][i];\n              name = true;\n            }\n          } else if (this.propertyNames[i] === 'amount' || this.propertyNames[i] === 'amounts') {\n            if (this.csvRecords[j][i] && (this.csvRecords[j][i] != '' || this.csvRecords[j][i] != ' ')) {\n              hashamp['amount'] = parseInt(this.csvRecords[j][i]);\n              amount = true;\n            }\n          } else if (this.propertyNames[i] === 'expense date' || this.propertyNames[i] === 'date' || this.propertyNames[i] === 'expense_date') {\n            if (this.csvRecords[j][i] && (this.csvRecords[j][i] != '' || this.csvRecords[j][i] != ' ')) {\n              hashamp['expense_date'] = this.csvRecords[j][i];\n              expense_date = true;\n            }\n          } else if (this.propertyNames[i] === 'payment' || this.propertyNames[i] === 'payment_type' || this.propertyNames[i] === 'payment type') {\n            if (this.csvRecords[j][i] && (this.csvRecords[j][i] != '' || this.csvRecords[j][i] != ' ')) {\n              hashamp['payment_type'] = this.csvRecords[j][i];\n              payment_type = true;\n            }\n          } else if (this.propertyNames[i] === 'expense_category' || this.propertyNames[i] === 'expense category' || this.propertyNames[i] === 'category') {\n            if (this.csvRecords[j][i] && (this.csvRecords[j][i] != '' || this.csvRecords[j][i] != ' ')) {\n              hashamp['expense_category'] = this.csvRecords[j][i];\n              expense_category = true;\n            }\n          } else if (this.propertyNames[i] === 'comments' || this.propertyNames[i] === 'comment') {\n            if (this.csvRecords[j][i] && (this.csvRecords[j][i] != '' || this.csvRecords[j][i] != ' ')) {\n              hashamp['comment'] = this.csvRecords[j][i];\n              comment = true;\n            }\n          }\n        }\n        if (!name || !amount || !expense_date) {\n          this.snackBar.open('Please Mention required Fields Properly', '', {\n            duration: 2000\n          });\n          return;\n        }\n        if (hashamp['expense_date'].split('/')[2].length != 4) {\n          this.snackBar.open('Date Format DD/MM/YYYY', '', {\n            duration: 2000\n          });\n          return;\n        }\n        if (parseInt(hashamp['expense_date'].split('/')[1]) > 12) {\n          this.snackBar.open('Date Format DD/MM/YYYY', '', {\n            duration: 2000\n          });\n          return;\n        }\n        if (!expense_category) {\n          hashamp['expense_category'] = 'Unassigned';\n        }\n        if (!payment_type) {\n          hashamp['payment_type'] = 'Card';\n        }\n        if (!comment) {\n          hashamp['comment'] = 'Unassigned Expense';\n        }\n        this.onSaveExpense(hashamp);\n        // }\n      }\n    }\n\n    onSaveExpense(body) {\n      this.businessData.onImportExpense(body).subscribe(res => {\n        if (res.success === true || res.statusCode === 200 || res.statusCode === 201) {\n          // Expense added successfully\n        }\n      }, error => {\n        this.snackBar.open(error.message, ' ', {\n          duration: 2000\n        });\n      });\n    }\n    importDataFromCSV(event) {\n      if (event.target.files[0].type !== 'text/csv') {\n        this.dialog.open(AlertBoxComponent, {\n          data: {\n            type: 'error'\n          }\n        });\n        return;\n      }\n      let files = event.target.files; // FileList object\n      let file = files[0];\n      var reader = new FileReader();\n      reader.readAsText(file);\n      reader.onload = event => {\n        let csv = event.target.result; // Content of CSV file\n        csv = csv.toString();\n        let allTextLines = csv.split(/\\r\\n|\\n/);\n        let headers = allTextLines[0].split(',');\n        for (let i = 0; i < allTextLines.length - 1; i++) {\n          allTextLines[i] = allTextLines[i].split(',');\n        }\n        this.csvRecords = allTextLines;\n      };\n    }\n  }\n  ImportComponent.ɵfac = function ImportComponent_Factory(t) {\n    return new (t || ImportComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.BusinessDataService));\n  };\n  ImportComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ImportComponent,\n    selectors: [[\"app-import\"]],\n    decls: 47,\n    vars: 5,\n    consts: [[\"linear\", \"true\"], [\"stepper\", \"\"], [\"editable\", \"true\"], [\"matStepLabel\", \"\"], [1, \"tables\"], [1, \"table-container\"], [\"mat-table\", \"\", 1, \"mat-elevation-z8\", 3, \"dataSource\"], [\"matColumnDef\", \"name\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"amount\"], [\"matColumnDef\", \"date\"], [\"matColumnDef\", \"category\"], [\"matColumnDef\", \"payment\"], [\"matColumnDef\", \"comment\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [2, \"padding-top\", \"10px\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", \"matStepperNext\", \"\", \"type\", \"button\", 3, \"click\"], [\"type\", \"file\", \"hidden\", \"\", 3, \"change\"], [\"filePicker\", \"\"], [4, \"ngIf\"], [\"mat-raised-button\", \"\", \"matStepperPrevious\", \"\"], [\"mat-raised-button\", \"\", \"matStepperNext\", \"\", \"color\", \"primary\", 3, \"click\"], [1, \"view\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]],\n    template: function ImportComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r28 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"mat-stepper\", 0, 1)(2, \"mat-step\", 2);\n        i0.ɵɵtemplate(3, ImportComponent_ng_template_3_Template, 1, 0, \"ng-template\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4)(5, \"div\", 5)(6, \"table\", 6);\n        i0.ɵɵelementContainerStart(7, 7);\n        i0.ɵɵtemplate(8, ImportComponent_th_8_Template, 2, 0, \"th\", 8);\n        i0.ɵɵtemplate(9, ImportComponent_td_9_Template, 2, 0, \"td\", 9);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(10, 10);\n        i0.ɵɵtemplate(11, ImportComponent_th_11_Template, 2, 0, \"th\", 8);\n        i0.ɵɵtemplate(12, ImportComponent_td_12_Template, 2, 0, \"td\", 9);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(13, 11);\n        i0.ɵɵtemplate(14, ImportComponent_th_14_Template, 2, 0, \"th\", 8);\n        i0.ɵɵtemplate(15, ImportComponent_td_15_Template, 2, 0, \"td\", 9);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(16, 12);\n        i0.ɵɵtemplate(17, ImportComponent_th_17_Template, 2, 0, \"th\", 8);\n        i0.ɵɵtemplate(18, ImportComponent_td_18_Template, 2, 0, \"td\", 9);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(19, 13);\n        i0.ɵɵtemplate(20, ImportComponent_th_20_Template, 2, 0, \"th\", 8);\n        i0.ɵɵtemplate(21, ImportComponent_td_21_Template, 2, 0, \"td\", 9);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(22, 14);\n        i0.ɵɵtemplate(23, ImportComponent_th_23_Template, 2, 0, \"th\", 8);\n        i0.ɵɵtemplate(24, ImportComponent_td_24_Template, 2, 0, \"td\", 9);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵtemplate(25, ImportComponent_tr_25_Template, 1, 0, \"tr\", 15);\n        i0.ɵɵtemplate(26, ImportComponent_tr_26_Template, 1, 0, \"tr\", 16);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(27, \"div\", 17)(28, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function ImportComponent_Template_button_click_28_listener() {\n          i0.ɵɵrestoreView(_r28);\n          const _r16 = i0.ɵɵreference(31);\n          return i0.ɵɵresetView(_r16.click());\n        });\n        i0.ɵɵtext(29, \" Import File \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"input\", 19, 20);\n        i0.ɵɵlistener(\"change\", function ImportComponent_Template_input_change_30_listener($event) {\n          return ctx.importDataFromCSV($event);\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(32, \"mat-step\", 2);\n        i0.ɵɵtemplate(33, ImportComponent_ng_template_33_Template, 1, 0, \"ng-template\", 3);\n        i0.ɵɵelementStart(34, \"div\", 17);\n        i0.ɵɵtemplate(35, ImportComponent_p_35_Template, 2, 0, \"p\", 21);\n        i0.ɵɵtemplate(36, ImportComponent_p_36_Template, 2, 0, \"p\", 21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"div\")(38, \"button\", 22);\n        i0.ɵɵtext(39, \"Back\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"button\", 23);\n        i0.ɵɵlistener(\"click\", function ImportComponent_Template_button_click_40_listener() {\n          return ctx.onSaveImport();\n        });\n        i0.ɵɵtext(41, \" Save \");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(42, \"mat-step\");\n        i0.ɵɵtemplate(43, ImportComponent_ng_template_43_Template, 1, 0, \"ng-template\", 3);\n        i0.ɵɵelementStart(44, \"div\", 24)(45, \"button\", 25);\n        i0.ɵɵlistener(\"click\", function ImportComponent_Template_button_click_45_listener() {\n          return ctx.onView();\n        });\n        i0.ɵɵtext(46, \" View Expenses \");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"dataSource\", ctx.dataSource);\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngIf\", ctx.isCorrect);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isCorrect);\n      }\n    },\n    dependencies: [i5.NgIf, i6.MatButton, i7.MatTable, i7.MatHeaderCellDef, i7.MatHeaderRowDef, i7.MatColumnDef, i7.MatCellDef, i7.MatRowDef, i7.MatHeaderCell, i7.MatCell, i7.MatHeaderRow, i7.MatRow, i8.MatStep, i8.MatStepLabel, i8.MatStepper, i8.MatStepperNext, i8.MatStepperPrevious],\n    styles: [\".mat-stepper-horizontal[_ngcontent-%COMP%]{margin-top:8px}.mat-mdc-form-field[_ngcontent-%COMP%]{margin-top:16px}.view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}table[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.table-container[_ngcontent-%COMP%]{max-width:100%;overflow-x:scroll}.tables[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:contents}\"]\n  });\n  return ImportComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}